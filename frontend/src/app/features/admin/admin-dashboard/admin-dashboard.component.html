<div class="admin-dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <div>
        <h1 class="dashboard-title">Admin Dashboard</h1>
        <p class="dashboard-subtitle">Welcome back! Here's what's happening with your platform.</p>
      </div>
      <div class="header-actions">
        <div class="period-selector">
          <button
            [class.active]="selectedPeriod() === 7"
            (click)="onPeriodChange(7)"
            class="period-btn">
            7 Days
          </button>
          <button
            [class.active]="selectedPeriod() === 30"
            (click)="onPeriodChange(30)"
            class="period-btn">
            30 Days
          </button>
          <button
            [class.active]="selectedPeriod() === 90"
            (click)="onPeriodChange(90)"
            class="period-btn">
            90 Days
          </button>
        </div>
        <button (click)="refresh()" class="refresh-btn">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
          </svg>
          Refresh
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Loading dashboard data...</p>
    </div>
  }

  <!-- Error State -->
  @if (error()) {
    <div class="error-container">
      <div class="error-icon">⚠️</div>
      <p>{{ error() }}</p>
      <button (click)="refresh()" class="retry-btn">Try Again</button>
    </div>
  }

  <!-- Dashboard Content -->
  @if (!loading() && !error() && stats()) {
    <div class="dashboard-content">
      <!-- KPI Cards -->
      <app-kpi-cards [stats]="stats()!"></app-kpi-cards>

      <!-- Charts Grid -->
      <div class="charts-grid">
        <!-- Revenue Chart -->
        <div class="chart-card">
          <app-revenue-chart [days]="selectedPeriod()"></app-revenue-chart>
        </div>

        <!-- Booking Chart -->
        <div class="chart-card">
          <app-booking-chart [days]="selectedPeriod()"></app-booking-chart>
        </div>

        <!-- User Chart -->
        <div class="chart-card">
          <app-user-chart [days]="selectedPeriod()"></app-user-chart>
        </div>

        <!-- Listing Chart -->
        <div class="chart-card">
          <app-listing-chart></app-listing-chart>
        </div>
      </div>

      <!-- Quick Actions & Recent Activity -->
      <div class="bottom-grid">
        <!-- Quick Actions -->
        <div class="quick-actions-card">
          <h3 class="section-title">Quick Actions</h3>
          <div class="quick-actions-grid">
            <a routerLink="/admin/users" class="quick-action">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
              </svg>
              <div>
                <div class="action-title">Manage Users</div>
                <div class="action-description">View and manage all users</div>
              </div>
            </a>

            <a routerLink="/admin/listings" class="quick-action">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
              </svg>
              <div>
                <div class="action-title">Manage Listings</div>
                <div class="action-description">Review pending listings</div>
              </div>
            </a>

            <a routerLink="/admin/bookings" class="quick-action">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
              </svg>
              <div>
                <div class="action-title">View Bookings</div>
                <div class="action-description">Manage all bookings</div>
              </div>
            </a>

            <a routerLink="/admin/audit-logs" class="quick-action">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
              </svg>
              <div>
                <div class="action-title">Audit Logs</div>
                <div class="action-description">View system audit trail</div>
              </div>
            </a>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="recent-activity-card">
          <h3 class="section-title">Recent Activity</h3>
          <div class="activity-stats">
            <div class="activity-item">
              <div class="activity-icon logins">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                </svg>
              </div>
              <div class="activity-details">
                <div class="activity-value">{{ stats()?.recentActivity?.recentLogins || 0 }}</div>
                <div class="activity-label">Recent Logins</div>
              </div>
            </div>

            <div class="activity-item">
              <div class="activity-icon bookings">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                </svg>
              </div>
              <div class="activity-details">
                <div class="activity-value">{{ stats()?.recentActivity?.recentBookings || 0 }}</div>
                <div class="activity-label">New Bookings</div>
              </div>
            </div>

            <div class="activity-item">
              <div class="activity-icon payments">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z" />
                </svg>
              </div>
              <div class="activity-details">
                <div class="activity-value">{{ stats()?.recentActivity?.recentPayments || 0 }}</div>
                <div class="activity-label">Payments</div>
              </div>
            </div>

            <div class="activity-item">
              <div class="activity-icon approvals">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <div class="activity-details">
                <div class="activity-value">{{ stats()?.recentActivity?.pendingApprovals || 0 }}</div>
                <div class="activity-label">Pending Approvals</div>
              </div>
            </div>

            <div class="activity-item">
              <div class="activity-icon reviews">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
                </svg>
              </div>
              <div class="activity-details">
                <div class="activity-value">{{ stats()?.recentActivity?.recentReviews || 0 }}</div>
                <div class="activity-label">New Reviews</div>
              </div>
            </div>

            <div class="activity-item">
              <div class="activity-icon cancellations">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <div class="activity-details">
                <div class="activity-value">{{ stats()?.recentActivity?.recentCancellations || 0 }}</div>
                <div class="activity-label">Cancellations</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>
